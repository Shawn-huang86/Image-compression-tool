<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片压缩工具</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>图片压缩工具</h1>
            <p>支持 JPEG/PNG/WebP/AVIF 格式，纯本地处理，无需网络上传</p>
        </header>

        <main class="main-layout">
            <!-- 左栏：上传区域 -->
            <div class="upload-panel">
                <section class="upload-section">
                    <h3>选择图片</h3>
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-content">
                            <div class="upload-icon">📁</div>
                            <p>拖拽图片到此处</p>
                            <p class="upload-hint">支持 JPEG、PNG、WebP、HEIC</p>
                            <input type="file" id="fileInput" multiple accept="image/*,.heic,.heif" hidden>
                            <button class="btn btn-primary" id="selectBtn">选择图片</button>
                        </div>
                    </div>
                    
                    <div class="upload-status" id="uploadStatus" style="display: none;">
                        <div class="status-item">
                            <span class="status-label">已选择:</span>
                            <span class="status-value" id="fileCount">0</span> 张图片
                        </div>
                    </div>
                </section>

                <section class="progress-section" id="progressSection" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p id="progressText">处理中...</p>
                </section>
            </div>

            <!-- 中栏：压缩设置 -->
            <div class="settings-panel">
                <section class="controls-section" id="controlsSection">
                    <h3>压缩设置</h3>
                    <div class="controls">
                        <div class="control-group">
                            <label for="qualitySlider">压缩质量: <span id="qualityValue">0.8</span></label>
                            <input type="range" id="qualitySlider" min="0.1" max="1" step="0.1" value="0.8">
                        </div>
                        <div class="control-group">
                            <label for="maxWidthInput">最大宽度 (px):</label>
                            <input type="number" id="maxWidthInput" value="2000" min="100" max="8000">
                        </div>
                        <div class="control-group">
                            <label for="maxHeightInput">最大高度 (px):</label>
                            <input type="number" id="maxHeightInput" value="2000" min="100" max="8000">
                        </div>
                        <div class="control-group">
                            <label for="formatSelect">输出格式:</label>
                            <select id="formatSelect">
                                <option value="jpeg">JPEG</option>
                                <option value="png">PNG</option>
                                <option value="webp">WebP</option>
                            </select>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="compressBtn">开始压缩</button>
                        <button class="btn btn-secondary" id="clearBtn">清空</button>
                    </div>
                </section>
            </div>

            <!-- 右栏：压缩结果 -->
            <div class="results-panel">
                <section class="results-section" id="resultsSection">
                    <div class="results-header">
                        <h3>压缩结果</h3>
                        <div class="results-controls">
                            <div class="view-toggle">
                                <button class="btn-toggle active" id="compactViewBtn" title="紧凑视图">☰</button>
                                <button class="btn-toggle" id="cardViewBtn" title="卡片视图">⊞</button>
                            </div>
                            <div class="download-buttons">
                                <button class="btn btn-success" id="downloadAllBtn" style="display: none;">下载全部 (ZIP)</button>
                                <button class="btn btn-secondary" id="downloadSelectedBtn" style="display: none;">下载选中</button>
                            </div>
                        </div>
                    </div>
                    <div class="results-placeholder" id="resultsPlaceholder">
                        <div class="placeholder-content">
                            <div class="placeholder-icon">🖼️</div>
                            <p>压缩结果将在这里显示</p>
                            <p class="placeholder-hint">选择图片并开始压缩后，结果会实时显示在这里</p>
                        </div>
                    </div>
                    <div class="results-grid" id="resultsGrid"></div>
                </section>
            </div>
        </main>
    </div>

    <div class="theme-toggle" id="themeToggle">🌓</div>

    <script type="module" src="./main.ts"></script>
</body>
</html>